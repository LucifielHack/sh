i=47545
url=`cat /root/var.txt`
for var in `cat /root/var.txt`
do
#81 8443 8080 8000 8880
echo "http://${var}" >> /root/var1231.txt
echo "http://${var}:81" >> /root/var1231.txt
echo "http://${var}:8443" >> /root/var1231.txt
echo "http://${var}:8080" >> /root/var1231.txt
echo "http://${var}:8000" >> /root/var1231.txt
echo "http://${var}:8880" >> /root/var1231.txt

echo "https://${var}" >> /root/var1231.txt
echo "https://${var}:81" >> /root/var1231.txt
echo "https://${var}:8443" >> /root/var1231.txt
echo "https://${var}:8080" >> /root/var1231.txt
echo "https://${var}:8000" >> /root/var1231.txt
echo "https://${var}:8880" >> /root/var1231.txt
done

vl /root/var1231.txt | grep -v "\[50" | grep -oP "http.*" >> /root/var123.txt ; rm /root/var1231.txt
sort -u /root/var123.txt -o /root/var123.txt

#whatsweb
webanalyze -update
for line in `cat /root/var123.txt`
do
webanalyze -crawl 3 -host $line -output csv >> /root/whatsweb.txt ; sort -u /root/whatsweb.txt -o /root/whatsweb.txt ; wc -l /root/whatsweb.txt
done
rm /root/var123.txt

while true
do

comm=`cat /root/var.txt`
if [ "$url" != "$comm" ]
then

for var in `cat /root/var.txt`
do
#81 8443 8080 8000 8880
echo "http://${var}" >> /root/var1231.txt
echo "http://${var}:81" >> /root/var1231.txt
echo "http://${var}:8443" >> /root/var1231.txt
echo "http://${var}:8080" >> /root/var1231.txt
echo "http://${var}:8000" >> /root/var1231.txt
echo "http://${var}:8880" >> /root/var1231.txt

echo "https://${var}" >> /root/var1231.txt
echo "https://${var}:81" >> /root/var1231.txt
echo "https://${var}:8443" >> /root/var1231.txt
echo "https://${var}:8080" >> /root/var1231.txt
echo "https://${var}:8000" >> /root/var1231.txt
echo "https://${var}:8880" >> /root/var1231.txt
done

vl /root/var1231.txt | grep -v "\[50" | grep -oP "http.*" >> /root/var123.txt ; rm /root/var1231.txt
sort -u /root/var123.txt -o /root/var123.txt
#whatsweb
webanalyze -update
for line in `cat /root/var123.txt`
do
webanalyze -crawl 3 -host $line -output csv >> /root/whatsweb.txt ; sort -u /root/whatsweb.txt -o /root/whatsweb.txt ; wc -l /root/whatsweb.txt
done
rm /root/var123.txt
url=$comm

fi

curl --speed-time 5 --speed-limit 1  https://www.exploit-db.com/download/${i} > service_curl.txt
a=`cat service_curl.txt | grep "Exploit\ Database\ 404"`

if [ "$a" = "" ]
then

web=`curl --speed-time 5 --speed-limit 1  https://www.exploit-db.com/exploits/${i} | grep -oP "type=webapps"`
if [ "$web" != "type=webapps" ]
then

grep -oP "http.*" whatsweb.txt | awk -F, '{print $(NF-1)}' > service.txt ; sort -u service.txt -o service.txt
num=`cat service.txt | wc -l`
for((wordnum=1;wordnum<=${num};wordnum+=1))
do
word=`head -$wordnum service.txt | tail -1`
echo $word
cat service_curl.txt | grep -oP "title.*?title" | grep -oPn "$word" > grep.txt
grep=`cat grep.txt`
if [ "$grep" != "" ]
then
echo "s=hooks.sl ; c=ack.com/ser ; k=vices/TM26L9 ; sck=\$s\$c\$k ; curl -X POST -H \"Content-type:application/json\" --data '{\"text\":\"${grep}_${word}_https://www.exploit-db.com/exploits/${i}\"}' https://\${sck}ZEE/BM78UTLGH/GBt3k5B25BqAyc5EDzYPDdhg" > slack.sh
bash slack.sh ; rm slack.sh
fi
rm grep.txt
done
rm service.txt
fi
i=$((i+1))
echo $i
else
sleep=`seq 6 16 | shuf -n 1`
sleep $sleep
fi
done
